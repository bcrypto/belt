\begin{appendix}{В}{обязательное}{Квоты ключей шифрования данных}\label{QUOTAS}

\mbox{}

Алгоритмы шифрования~\algname{belt-cbc}, \algname{belt-cfb}, 
\algname{belt-ctr}, \algname{belt-dwp}, \algname{belt-che} остаются 
надежными до тех пор, пока соблюдаются квоты для используемых в них ключей.
%
Квота ключа~--- это максимальный объем данных, которые разрешается
зашифровать на этом ключе. Квота задается количеством блоков 
зашифровываемых сообщений, которое нельзя превысить. 
Учитываются, в том числе, последние и поэтому возможно неполные блоки. 
%
В алгоритмах \algname{belt-dwp}, \algname{belt-che} каждая имитовставка 
засчитывается как блок.

Надежность алгоритмов шифрования означает, что гипотетическому 
противнику трудно отличить зашифрованные сообщения~$Y$ от случайных слов. 
Противник выбирает открытые сообщения~$X$, управляет синхропосылками~$S$ 
по правилам, изложенным в~\ref{COMMON.IV}, и получает в ответ 
либо штатные~$Y$, вычисленные на неизвестном ключе~$K$, либо случайные слова 
такой же длины. Противнику предлагается распознать тип преобразования,
которое применяется к сообщениям~$X$: случайное или штатное. 

Качество распознавания характеризует преобладание~$p$.
Оно имеет вид~$|1-\alpha-\beta|$, 
где~$\alpha$~--- вероятность признать случайное преобразование штатным,
$\beta$~--- вероятность признать штатное преобразование случайным.
%
Величина~$p$ является оценкой сверху для вероятности успеха любой разумной атаки
на алгоритм шифрования при выбираемых~$X$. В частности, малость~$p$
означает трудность получения по~$Y$ любой информации о сообщении~$X$,
кроме его длины.

Квота ключа ограничивает преобладание~$p$.
%
В таблице~\ref{Table.QUOTAS.1} представлены квоты, 
при соблюдении которых~$p$ не превышает пороги~$2^{-32}$, $2^{-48}$, 
$2^{-64}$. Пороги определяют уровень гарантий безопасности шифрования.
Первый порог дает средние гарантии, 
второй~--- высокие, третий~--- максимальные.

\mbox{}

\if0
Если точное значение~$D$ неизвестно, то можно использовать оценку 
сверху для него.

При выборе~$p$ следует учитывать количество ключей сети связи.
При использовании~$L$ ключей и соблюдении квот вероятность
ослабления хотя бы одного узла сети не превосходит $Lp$.
\fi

\begin{table}[bht]
\caption{Квоты ключей}
\label{Table.QUOTAS.1}
\begin{tabular}{|p{0.2cm}l|c|c|c|c|c|c|c|}
\hline
\multicolumn{2}{|c|}{Уровень гарантий} & 
\algname{belt-cbc} & 
\algname{belt-cfb} & 
\algname{belt-ctr} & 
\algname{belt-dwp} & 
\algname{belt-che}\\
\hline
\hline
\rule{0pt}{18pt}
&Средний ($p\leq 2^{-32}$) & 
$2^{48}$ & 
$2^{48}$ & 
$2^{48}\sqrt{\frac{2}{3}}$ &
$2^{48}\sqrt{\frac{2}{7D+7}}$ &
$2^{48}\sqrt{\frac{2}{5D+7}}$\\[6pt]
\hline
\rule{0pt}{18pt}
&Высокий ($p\leq 2^{-48}$) & 
$2^{40}$ & 
$2^{40}$ & 
$2^{40}\sqrt{\frac{2}{3}}$ &
$2^{40}\sqrt{\frac{2}{7D+7}}$ &
$2^{40}\sqrt{\frac{2}{5D+7}}$\\[6pt]
\hline
\rule{0pt}{18pt}
&Максимальный ($p\leq 2^{-64}$) & 
$2^{32}$ & 
$2^{32}$ & 
$2^{32}\sqrt{\frac{2}{3}}$ &
$2^{32}\sqrt{\frac{2}{7D+7}}$ &
$2^{32}\sqrt{\frac{2}{5D+7}}$\\[6pt]
\hline
\end{tabular}
\end{table}

Величина~$D$ в последних двух столбцах таблицы~--- это максимальное 
суммарное количество блоков~$X$ и~$I$ вместе с блоком 
длин~$\itob{|X|}_{64}\parallel\itob{|I|}_{64}$, 
обрабатываемых алгоритмом~\algname{belt-dwp} или~\algname{belt-che}
в целевой системе защиты информации. 

\begin{example*}
Пусть данные в системе обрабатываются пакетами.
Защищенный пакет состоит из заголовка~$I$, синхропосылки~$S$,  
результата зашифрования сообщения~$X$ и имитовставки~$T$.
Пусть длина~$I$ (в октетах) равняется $46$, а длина~$X$ (снова в октетах) 
не превосходит~$1408$. Тогда
$$
D=\left\lceil 46/16\right\rceil+
\left\lceil 1408/16\right\rceil+1=
3+88+1=92.
$$
Если используется алгоритм~\algname{belt-dwp}, то для обеспечения максимальных 
гарантий безопасности суммарное число блоков~$X$ и имитовставок~$T$ не должно 
превосходить 
$$
2^{32}\sqrt{\frac{2}{7\cdot 92 + 7}}\approx 2^{27.8}.
$$
\end{example*}

Квоты не вводятся для ключей алгоритмов шифрования, в которых 
синхропосылка~$S$ либо не используется (\algname{belt-ecb}),
либо ее разрешается многократно использовать с выбранным ключом 
(\algname{belt-bde}, \algname{belt-sde}, \algname{belt-fmt}). 
%
Для таких алгоритмов повтор~$X$ или $(X,S)$ приводит к повтору~$Y$,
и описанная выше концепция надежности неприменима.

Квоты не применяются, если зашифровываются ключи и другие высокоэнтропийные 
данные, которыми не может манипулировать противник.

\end{appendix}
